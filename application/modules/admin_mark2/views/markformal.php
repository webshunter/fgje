<style type="text/css">
.zui-wrapper{
  position: relative;
  padding: 0;
  margin: 1%;
  width: 98%;
}

.zui-scroller{
  width: 100%;
  overflow-x: scroll;
  padding: 0;
  margin: 0;
}

.zui-table{
  border-collapse: collapse;
}

.zui-table th, .zui-table td{
  border: 1px solid black;
  white-space: nowrap;
  padding: 5px;
}

.clone {
  position:absolute;
  top:0;
  left:0;
  pointer-events:none;
}
.clone th, .clone td {
  visibility:hidden
}
.clone td, .clone th {
  border-color:transparent
}
.clone tbody th {
  visibility:visible;
  color:red;
}
.clone .fixed-side {
  border:1px solid #000;
  background-color: orange ;
  visibility:visible;
}

.clone .fixed-side2 {
  border:1px solid #000;
  background-color: white ;
  visibility:visible;
}

.clone thead, .clone tfoot{background:transparent;}

.pagin{
    display: block;
}

.pagin li{
    list-style: none;
    display: inline-block;
}

.pagin a{
    padding: 10px;
    display: inline-block;
    text-decoration: none;
}

.orange{
    background-color: orange;
    color: white;
    font-size: 14px;
    padding: 5px;
}

.pink{
    background-color: #dd0055;
    color: white;
    font-size: 14px;
    padding: 5px;
}

.yellow{
    background-color: yellow;
    color: black;
    font-size: 14px;
    padding: 5px;
}

#cari{
    margin: 5px;
    padding: 3px;
}

.navigasi-pencarian input{
  display: inline;
}

#agenid{
  padding: 5px;
}

#terbang{
  padding: 5px;
  margin-right: 5px;
}
</style>

<div class="page-header">
    <div class="page-header-content">
        <div class="page-title">
            <h2>
                <span class="text-semibold"><i class="icon-star-full2" style="color: #f34541;font-size:25px;"></i> PROGRESS MARKETING FORMAL</span>
            </h2>
        </div>
    </div>
</div>


<div class="page-container">
    <div class="page-content">
        <div class="content-wrapper">
            <div class="panel">
                <div class="panel-heading bg-teal-700">
                    <h5 class="panel-title">PROGRESS MARKETING PABRIK-JOMPO - 工廠+養護機構 -進度表. </h5>
                </div>
                <div class="panel-body">
                </div>
            </div>
            <div class="panel" id="panel_agenats">
                <div class="zui-wrapper" id="zui-wrapper">
                  <div class="zui-scroller">
                    <table class="zui-table">
                      <thead>
                       <tr>
                          <th rowspan="4" class="fixed-side orange">NO</th>
                          <th class="fixed-side orange"></th>
                          <th class="fixed-side orange"></th>
                          <th class="fixed-side orange"></th>
                          <th class="orange"></th>
                          <th class="orange"></th>
                          <th colspan="11" class="orange">初始過程 PROSES AWAL</th>
                          <th colspan="3" class="yellow">挑到雇主 DAPAT MAJIKAN</th>
                          <th colspan="7" class="pink">離境 KEBERANGKATAN</th>
                          <th colspan="11">DOKUMEN DARI TAIWAN - 臺灣文件</th>
                          <th colspan="25">PROSES DOK DI INDONESIA (印尼文件）</th>
                        </tr>
                        <tr>
                          <th colspan="3" class="fixed-side orange">外勞 - TKI</th>
                          <th class="orange">雇主</th>
                          <th class="orange"></th>
                          <th rowspan="2" class="orange">履歷表給臺灣日期</th>
                          <th colspan="4" class="orange">勞工網上報名 TKI ONLINE DEPNAKER</th>
                          <th colspan="6" class="orange">訓練 PELATIHAN</th>
                          <th rowspan="2" class="yellow">挑工 日期</th>
                          <th rowspan="2" class="yellow">聘工表</th>
                          <th rowspan="2" class="yellow">雇主要求入境</th>
                          <th colspan="2" rowspan="2" class="pink">入境 MASUK TAIWAN</th>
                          <th rowspan="2" class="pink">班機</th>
                          <th rowspan="2" class="pink">下機張</th>
                          <th rowspan="2" class="pink">機票-</th>
                          <th colspan="2" rowspan="2" class="pink">飛TERBANG</th>
                          <th class="pink">勞動契約 PK</th>
                          <th colspan="5">核准函 SUHAN</th>
                          <th colspan="5">簽證函 VISA PERMIT</th>
                          <th rowspan="2">久護照 PASPOR LAMA</th>
                          <th colspan="6">新護照 PASPOR BARU</th>
                          <th colspan="5">良民證 </th>
                          <th colspan="2">MEDIKAL FULL-大 體檢</th>
                          <th colspan="6">VISA 簽證</th>
                          <th colspan="5">日期 TGL</th>
                          <th>備註</th>
                        </tr>
                        <tr>
                          <th class="fixed-side orange">編號</th>
                          <th class="fixed-side orange"></th>
                          <th class="fixed-side orange">姓名 NAMA</th>
                          <th class="orange">MAJIKAN</th>
                          <th class="orange"></th>
                          <th rowspan="2" class="orange">日期 TGL</th>
                          <th rowspan="2" class="orange">實A / 估-C</th>
                          <th class="orange">勞工網上報名號碼</th>
                          <th class="orange">護照號碼</th>
                          <th class="orange">KEY日期</th>
                          <th class="orange">訓練(天)</th>
                          <th colspan="2" class="orange">完整 SELESAI DURASI</th>
                          <th colspan="2" class="orange">考試 UJIAN</th>
                          <th rowspan="2" class="yellow">受到日期 TGL TERIMA</th>
                          <th class="yellow">收件日</th>
                          <th rowspan="2" class="yellow">號碼 NO</th>
                          <th colspan="2" class="pink">日期 TGL</th>
                          <th class="pink">備註</th>
                          <th class="pink">收件日</th>
                          <th rowspan="2" class="pink">號碼 NO</th>
                          <th colspan="2" class="pink">日期 TGL</th>
                          <th class="pink">備註</th>
                          <th colspan="6" class="pink">日期 TGL</th>
                          <th colspan="5">日期 TGL</th>
                          <th colspan="2">日期 TGL</th>
                          <th colspan="6">日期 TGL</th>
                          <th rowspan="2">貸款 LOAN</th>
                          <th rowspan="2">受訓-PAP</th>
                          <th rowspan="2">實A / 估-C</th>
                          <th rowspan="2">外勞卡 KTKLN</th>
                          <th rowspan="2">實A / 估-C</th>
                          <th rowspan="2">KETERANGAN</th>
                          <th rowspan="2">KETERANGAN 2</th>


                          
                        </tr>
                        <tr>
                          <th class="fixed-side orange">NO_INDUK</th>
                          <th class="fixed-side orange">INDONESIA</th>
                          <th class="fixed-side orange">MANDARIN</th>
                          <th class="orange">MANDARIN</th>
                          <th class="orange">ENGLISH</th>
                          <th class="orange">TGL KIRIM BIO KE TAIWAN</th>
                          <th class="orange">NO ID ONLINE</th>
                          <th class="orange">NO PASPORT</th>
                          <th class="orange">TGL UPDATE</th>
                          <th class="orange">SUDAH MENGIKUTI PELATIHAN (HARI)</th>
                          <th class="orange">TGL日期</th>
                          <th class="orange">實A / 估-C</th>
                          <th class="orange">TGL日期</th>
                          <th class="orange">實A / 估-C</th>
                          <th class="yellow">TGL TERPILIH</th>
                          <th class="yellow">JD</th>
                          <th class="yellow">TGL DIMINTA TERBANG</th>
                          <th class="pink">TGL日期</th>
                          <th class="pink">實A / 估-C</th>
                          <th class="pink">RUTE_PENERBANGAN</th>
                          <th class="pink">TUJUAN</th>
                          <th class="pink">TIKET</th>
                          <th class="pink">TGL日期</th>
                          <th class="pink">實A / 估-C</th>
                          <th>TGL TERIMA</th>
                          <th>發行 TERBIT</th>
                          <th>到期 EXP</th>
                          <th>KETERANGAN</th>
                          <th>TGL TERIMA</th>
                          <th>發行 TERBIT</th>
                          <th>到期 EXP</th>
                          <th>KETERANGAN</th>
                          <th>到期EXP</th>
                          <th>送 AJU</th>
                          <th>實A / 估-C</th>
                          <th>拍照 FOTO</th>
                          <th>實A / 估-C</th>
                          <th>受到 TERIMA</th>
                          <th>實A / 估-C</th>
                          <th>送PENGAJUAN</th>
                          <th>實A / 估-C</th>
                          <th>受到 TERIMA</th>
                          <th>實A / 估-C</th>
                          <th>到期 TGL EXP</th>
                          <th>作-DILAKUKAN</th>
                          <th>到期 EXP</th>
                          <th>抽獎 KOCOKAN</th>
                          <th>實A / 估-C</th>
                          <th>指纹 FINGER PRINT</th>
                          <th>實A / 估-C</th>
                          <th>領 TERIMA</th>
                          <th>實A / 估-C</th>
                        </tr>            
                      </thead>
                      <tbody class="one">
                          
                      </tbody>
                    </table>
                  </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="test">
  
</div>



<script type="text/javascript">
    $(document).ready(function(){
        $("<input type='text' id='cari' placeholder='pencarian...'></input>").insertBefore(".zui-wrapper");
        $("<select id='terbang' onchange='terbang()'><option value='0'>BELUM TERBANG</option><option value='1'>SUDAH TERBANG</option></select>").insertBefore(".zui-wrapper");
        $("<select id='agenid' onchange='pilihagen()'></select>").insertBefore(".zui-wrapper");
        $("<button id='printdata' style='margin-left:10px;' class='btn btn-success'>PRINT</button>").insertBefore(".zui-wrapper");
        sessionStorage.setItem("page", 0);
        sessionStorage.setItem("cari", "" );
        sessionStorage.setItem("pilihagen", "" );
        sessionStorage.setItem("terbang", "0" );
        dataformal();
        agengrup();
        pagination();
        $("<ol class='pagin'></ol>").insertAfter(".zui-wrapper");
        $("#cari").keyup(function(){
          var cari = $("#cari").val();
          sessionStorage.setItem("cari", cari );
          dataformal();
          pagination();
          agengrup();
        })

        $("#cari").click(function(){
          sessionStorage.setItem("page", 0);
        })

        $("#terbang").click(function(){
          var nilai = $(this).val();
          sessionStorage.setItem("terbang", nilai);
          dataformal();
          agengrup();
          pagination();
        })


        function editketerangan(){
          $(this).removeAttr('disabled');
        }

        $("#printdata").click(function(){
          var agen = sessionStorage.getItem("pilihagen");
          var terbang = sessionStorage.getItem("terbang");
          if(agen == ""){
            location.href = "<?= site_url(); ?>/admin_mark2/printdata/all/all/"+terbang+"/";
          }else{
            location.href = "<?= site_url(); ?>/admin_mark2/printdata/all/"+agen+"/"+terbang+"/";
          }
        });
    });
    

    function keterangan(key){
      $("input[name='"+key+"']").removeAttr("disabled");
      var kunci = "#data"+key;
      $(kunci).attr("value", "save");
      $(kunci).attr("onclick", "simpanKeterangan('"+key+"')");
    }

    function keterangan2(key){
      $("input[name='dua"+key+"']").removeAttr("disabled");
      var kunci = "#data2"+key;
      $(kunci).attr("value", "save");
      $(kunci).attr("onclick", "simpanKeterangan2('"+key+"')");
    }

    function simpanKeterangan(key){
      var kunci = "#data"+key;
      var dataTransfer = $("input[name='"+key+"']").val();
      $.ajax({
          url: "<?= site_url(); ?>/admin_mark2/ubahKeterangan",
          method: "POST",
          dataType: "text",
          data: {   
              iddata: key,
              dataTransfer: dataTransfer 
          }, success:function(response){
            $("input[name='"+key+"']").prop("disabled", "disabled");
            $("input[name='"+key+"']").attr("value", response);
            $(kunci).attr("value", "ubah");
            $(kunci).attr("onclick", "keterangan('"+key+"')");
          }
       });

      
      // $(kunci).attr("value", "ubah");
      // $(kunci).attr("onclick", "keterangan('"+key+"')");
      // $("input[name='"+key+"']").prop("disabled", true);
      // alert(dataTransfer);
    }
    function simpanKeterangan2(key){
      var kunci = "#data2"+key;
      var dataTransfer = $("input[name='dua"+key+"']").val();
      $.ajax({
          url: "<?= site_url(); ?>/admin_mark2/ubahKeterangan2",
          method: "POST",
          dataType: "text",
          data: {   
              iddata: key,
              dataTransfer: dataTransfer 
          }, success:function(response){
            $("input[name='dua"+key+"']").prop("disabled", "disabled");
            $("input[name='dua"+key+"']").attr("value", response);
            $(kunci).attr("value", "ubah");
            $(kunci).attr("onclick", "keterangan2('"+key+"')");
          }
       });
    }

    function agengrup(){
        var page = sessionStorage.getItem("page");
        var pencarian = sessionStorage.getItem("cari");
        var agen = sessionStorage.getItem("pilihagen");
        $.ajax({
            url: "<?= site_url(); ?>/admin_mark2/dataformal",
            method: "POST",
            dataType: "text",
            data: {
                key: "opsiagen",
                page: page,
                pencarian: pencarian,
                agen: agen
            }, success:function(response){
                $("#agenid").html(response);
            }
        });
    }

    function pilihagen(){
      var data = $("#agenid").val();
      sessionStorage.setItem("page", 0);
      sessionStorage.setItem("pilihagen", data);
      dataformal();
      agengrup();
      pagination();
    }    

    function dataformal(){
        var page = sessionStorage.getItem("page");
        var halaman = Number(page)*10;
        var pencarian = sessionStorage.getItem("cari");
        var agen = sessionStorage.getItem("pilihagen");
        var terbang = sessionStorage.getItem("terbang");
        $.ajax({
            url: "<?= site_url(); ?>/admin_mark2/dataformal",
            method: "POST",
            dataType: "text",
            data: {
                key: "data",
                blmterbang: terbang,
                page: halaman,
                pencarian: pencarian,
                agen: agen
            }, success:function(response){
                $(".one").html(response);
                jQuery(".zui-table:last").clone(true).appendTo('#zui-wrapper').addClass('clone');
            }
        });
    }

    function pagination(){
        var page = sessionStorage.getItem("page");
        var pencarian = sessionStorage.getItem("cari");
        var agen = sessionStorage.getItem("pilihagen");
        var terbang = sessionStorage.getItem("terbang");
        $.ajax({
            url: "<?= site_url(); ?>/admin_mark2/dataformal",
            method: "POST",
            dataType: "text",
            data: {
                key: "pagin",
                page: page,
                blmterbang: terbang,
                pencarian: pencarian,
                agen: agen
            }, success:function(response){
                $(".pagin").html(response);
            }
        });
    }

    function page(key, total){
      if (key == 'next') {
        var a = sessionStorage.getItem("page");
        var b = Number(a)+10;
        if (b > total) {
          sessionStorage.setItem("page", 0);
        }else{
          sessionStorage.setItem("page", b);
        }
        dataformal();
        pagination();
      }else if(key == 'prev'){
        var a = sessionStorage.getItem("page");
        if (a<10) {
          var b = Number(a)-1;
        }else{
          var b = Number(a)-10;
        }
        if (b < 0) {
          sessionStorage.setItem("page", (total-1));
        }else{
          sessionStorage.setItem("page", b);
        }
        dataformal();
        pagination();
      }else{
        var kunci = Number(key)/10;
        sessionStorage.setItem("page", kunci);
        dataformal();
        pagination();  
      }
    }
</script>